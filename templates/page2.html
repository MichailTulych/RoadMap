{% extends "base.html" %}

{% block title %}Data Science Roadmap{% endblock %}

{% block extra_css %}
<style>
    header {
        text-align: center;
        margin-bottom: 30px;
    }

    header h1 {
        font-size: 2.5em;
        margin: 0;
        color: #1a73e8;
    }

    header p {
        font-size: 1.1em;
        color: #666;
    }

    .progress-container {
        margin-top: 20px;
        text-align: center;
    }

    .progress-bar {
        width: 100%;
        background: #e0e0e0;
        border-radius: 5px;
        overflow: hidden;
        height: 20px;
        margin-bottom: 10px;
    }

    .progress {
        width: 0;
        height: 100%;
        background: #1a73e8;
        transition: width 0.3s ease;
    }

    .progress-text {
        font-size: 1em;
        color: #333;
        margin-bottom: 20px;
    }

    .roadmap {
        margin-top: 20px;
    }

    .section {
        border: 1px solid #ddd;
        border-radius: 5px;
        margin-bottom: 10px;
        overflow: hidden;
    }

    .section-header {
        background: #f7f7f7;
        padding: 15px;
        cursor: pointer;
        display: flex;
        justify-content: space-between;
        align-items: center;
        font-weight: 500;
        font-size: 1.2em;
        color: #333;
    }

    .section-header:hover {
        background: #e8f0fe;
    }

    .section-content {
        display: none;
        padding: 15px;
        background: #fff;
    }

    .section-content.show {
        display: block;
    }

    .subtask {
        display: flex;
        align-items: center;
        margin-bottom: 10px;
        font-size: 1em;
    }

    .subtask input[type="checkbox"] {
        margin-right: 10px;
        width: 20px;
        height: 20px;
    }

    .subtask.completed {
        text-decoration: line-through;
        color: #888;
    }

    .controls {
        display: flex;
        justify-content: center;
        gap: 10px;
        margin: 20px 0;
    }

    button {
        background: #1a73e8;
        color: #fff;
        border: none;
        padding: 10px 20px;
        border-radius: 5px;
        cursor: pointer;
        font-size: 1em;
        display: flex;
        align-items: center;
        gap: 5px;
    }

    button:hover {
        background: #1557b0;
    }

    footer {
        text-align: center;
        margin-top: 20px;
        font-size: 0.9em;
        color: #666;
    }

    @media (max-width: 600px) {
        .container {
            padding: 10px;
        }

        header h1 {
            font-size: 1.8em;
        }

        button {
            padding: 8px 15px;
            font-size: 0.9em;
        }

        .controls {
            flex-direction: column;
        }
    }
</style>
{% endblock %}

{% block content %}
<header>
    <h1><i class="fas fa-road"></i> Data Science Roadmap</h1>
    <p>Отмечайте выполненные задачи и следите за своим прогрессом в изучении Data Science</p>
    <div class="progress-container">
        <div class="progress-bar">
            <div class="progress" id="progress"></div>
        </div>
        <div class="progress-text" id="progress-text">0% завершено</div>
    </div>
</header>

<div class="roadmap" id="roadmap"></div>

<div class="controls">
    <button id="expand-all"><i class="fas fa-plus-circle"></i> Развернуть все</button>
    <button id="collapse-all"><i class="fas fa-minus-circle"></i> Свернуть все</button>
    <button id="reset"><i class="fas fa-redo"></i> Сбросить прогресс</button>
</div>

<footer>
    <p>Ваш прогресс автоматически сохраняется в локальном хранилище браузера</p>
</footer>
{% endblock %}

{% block extra_js %}
<script>
    const roadmapData = [
        {
            title: "Python",
            subtasks: [
                {
                    title: "Основы Python",
                    items: ["Переменные и типы данных", "Циклы (for, while) и условные операторы (if, elif, else)", "Функции и область видимости"]
                },
                {
                    title: "Структуры данных",
                    items: ["Массивы, списки, кортежи и множества", "Стеки и очереди", "Словари", "Списковые включения", "Генераторные выражения"]
                },
                {
                    title: "Обработка исключений",
                    items: ["Обработка исключений с try/except", "Вызов исключений"]
                },
                {
                    title: "Функциональное программирование",
                    items: ["Лямбда-функции", "Map, reduce, filter"]
                },
                {
                    title: "Объектно-ориентированное программирование",
                    items: ["Классы и объекты", "Наследование и полиморфизм"]
                },
                {
                    title: "Модули и пакеты",
                    items: ["Создание модулей", "Управление пакетами с pip и pipenv", "Виртуальные окружения"]
                },
                {
                    title: "Стандартная библиотека Python",
                    items: ["Работа с путями, файлами и директориями", "Работа с CSV и JSON файлами", "Работа с датой и временем", "Генерация случайных значений"]
                },
                {
                    title: "Знакомство с библиотеками для Data Science",
                    items: ["NumPy", "Pandas", "Matplotlib"]
                }
            ]
        },
        {
            title: "Контроль версий (Git)",
            subtasks: [
                {
                    title: "Настройка и конфигурация",
                    items: ["init, clone, config"]
                },
                {
                    title: "Стадия",
                    items: ["status, add, rm, mv, commit, reset"]
                },
                {
                    title: "Осмотр и сравнение",
                    items: ["log, diff, show"]
                },
                {
                    title: "Ветвление",
                    items: ["branch, checkout, merge"]
                },
                {
                    title: "Удалённые репозитории",
                    items: ["remote, fetch, pull, push"]
                },
                {
                    title: "Временные коммиты",
                    items: ["stash"]
                },
                {
                    title: "GitHub",
                    items: ["fork, pull request, code review"]
                }
            ]
        },
        {
            title: "Структуры данных и алгоритмы",
            subtasks: [
                {
                    title: "Основные концепции",
                    items: ["Нотация Big O", "Массивы и связанные списки", "Стеки и очереди", "Хэш-таблицы"]
                },
                {
                    title: "Деревья и графы",
                    items: ["Бинарные деревья", "AVL-деревья", "Кучи", "Префиксные деревья", "Графы"]
                },
                {
                    title: "Алгоритмы сортировки",
                    items: ["Пузырьковая сортировка", "Сортировка выбором", "Сортировка вставками", "Сортировка слиянием", "Быстрая сортировка", "Сортировка подсчётом", "Блочная сортировка"]
                },
                {
                    title: "Алгоритмы поиска",
                    items: ["Линейный поиск", "Бинарный поиск", "Тернарный поиск", "Поиск с прыжками", "Экспоненциальный поиск"]
                },
                {
                    title: "Алгоритмы работы со строками",
                    items: ["Реверс строки", "Реверс слов", "Ротации", "Удаление дубликатов", "Наиболее повторяющийся символ", "Анаграммы", "Палиндром"]
                },
                {
                    title: "Рекурсия",
                    items: ["Основы рекурсии"]
                }
            ]
        },
        {
            title: "SQL",
            subtasks: [
                {
                    title: "Основные операции",
                    items: ["Запрос данных (SELECT)", "Изменение данных (INSERT, UPDATE, DELETE)", "Фильтрация данных (WHERE, IN, BETWEEN, LIKE, IS NULL, REGEXP)", "Логические операторы (AND, OR, NOT)", "Сортировка и ограничение данных (ORDER BY, LIMIT)"]
                },
                {
                    title: "Сложные запросы",
                    items: ["Соединения (INNER, OUTER, SELF, NATURAL, CROSS)", "Агрегатные функции (MAX, MIN, AVG, SUM, COUNT)", "Группировка данных (GROUP BY, HAVING, ROLLUP)", "Подзапросы"]
                },
                {
                    title: "Дополнительно",
                    items: ["Представления (Views)", "Хранимые процедуры и функции", "Триггеры и события"]
                },
                {
                    title: "Транзакции",
                    items: ["Уровни изоляции транзакций", "BEGIN, COMMIT, ROLLBACK"]
                },
                {
                    title: "Проектирование баз данных",
                    items: ["Нормализация", "Целостность базы данных (первичные ключи, внешние ключи, ограничения)"]
                },
                {
                    title: "Индексы",
                    items: ["Создание и использование индексов"]
                },
                {
                    title: "Безопасность и разрешения",
                    items: ["Управление пользователями и привилегиями"]
                }
            ]
        },
        {
            title: "Математика и статистика",
            subtasks: [
                {
                    title: "Линейная алгебра",
                    items: ["Векторы и матрицы", "Матричные операции", "Собственные значения и собственные векторы", "Сингулярное разложение (SVD)"]
                },
                {
                    title: "Математический анализ",
                    items: ["Производные и градиенты", "Частные производные", "Правило цепи", "Интегралы"]
                },
                {
                    title: "Теория вероятностей",
                    items: ["Распределения вероятностей", "Теорема Байеса", "Случайные величины", "Математическое ожидание и дисперсия"]
                },
                {
                    title: "Статистика",
                    items: ["Описательная статистика (среднее, медиана, мода, стандартное отклонение)", "Проверка гипотез", "Доверительные интервалы", "Регрессионный анализ"]
                }
            ]
        },
        {
            title: "Сбор и визуализация данных",
            subtasks: [
                {
                    title: "Очистка данных",
                    items: ["Обработка пропущенных значений", "Удаление дубликатов", "Обнаружение и обработка выбросов"]
                },
                {
                    title: "Трансформация данных",
                    items: ["Нормализация и стандартизация", "Кодирование категориальных переменных", "Масштабирование признаков"]
                },
                {
                    title: "Исследовательский анализ данных (EDA)",
                    items: ["Сводная статистика", "Визуализация данных (Matplotlib, Seaborn)", "Выявление закономерностей и корреляций"]
                },
                {
                    title: "Интеграция данных",
                    items: ["Объединение и соединение наборов данных", "Агрегация данных", "Работа с различными форматами данных (CSV, JSON, SQL)"]
                }
            ]
        },
        {
            title: "Основы машинного обучения",
            subtasks: [
                {
                    title: "Обучение с учителем",
                    items: ["Регрессионные алгоритмы (линейная регрессия, логистическая регрессия)", "Классификационные алгоритмы (деревья решений, k-ближайших соседей, метод опорных векторов)"]
                },
                {
                    title: "Обучение без учителя",
                    items: ["Кластеризационные алгоритмы (K-means, иерархическая кластеризация)", "Методы уменьшения размерности (PCA, LDA)"]
                },
                {
                    title: "Оценка моделей",
                    items: ["Точность (Accuracy)", "Точность-Полнота (Precision-Recall)", "F1-оценка", "ROC-AUC", "Матрица ошибок"]
                },
                {
                    title: "Обучение моделей",
                    items: ["Разделение на обучающую и тестовую выборки", "Кросс-валидация", "Настройка гиперпараметров"]
                },
                {
                    title: "Переобучение и недообучение",
                    items: ["Распознавание переобучения и недообучения", "Методы предотвращения переобучения (регуляризация, dropout)", "Управление сложности модели"]
                }
            ]
        },
        {
            title: "Глубокое обучение",
            subtasks: [
                {
                    title: "Нейронные сети",
                    items: ["Основы нейронных сетей", "Функции активации", "Прямое и обратное распространение"]
                },
                {
                    title: "Продвинутые нейронные сети",
                    items: ["Свёрточные нейронные сети (CNN)", "Рекуррентные нейронные сети (RNN)"]
                },
                {
                    title: "Фреймворки глубокого обучения",
                    items: ["Инструменты: TensorFlow, PyTorch, Keras"]
                }
            ]
        },
        {
            title: "Специализация",
            subtasks: [
                {
                    title: "Обработка естественного языка (NLP)",
                    items: ["Предобработка текста (токенизация, стемминг, лемматизация)", "Анализ тональности", "Распознавание именованных сущностей (NER)", "Языковое моделирование (NLTK, SpaCy, Hugging Face)"]
                },
                {
                    title: "Компьютерное зрение",
                    items: ["Классификация изображений: методы и модели", "Обнаружение объектов: алгоритмы YOLO, SSD", "Сегментация изображений: семантическая и экземплярная", "Генеративные модели: GANs в компьютерном зрении"]
                }
            ]
        },
        {
            title: "Большие данные (опционально)",
            subtasks: [
                {
                    title: "Фреймворки больших данных",
                    items: ["Hadoop, Spark"]
                },
                {
                    title: "Обработка данных",
                    items: ["MapReduce, Spark SQL"]
                },
                {
                    title: "Хранение данных",
                    items: ["HDFS, NoSQL базы данных (Cassandra, MongoDB)"]
                },
                {
                    title: "Интеграция данных",
                    items: ["Kafka, Flume"]
                }
            ]
        }
    ];

    const roadmap = document.getElementById('roadmap');
    const progressBar = document.getElementById('progress');
    const progressText = document.getElementById('progress-text');
    const expandAllBtn = document.getElementById('expand-all');
    const collapseAllBtn = document.getElementById('collapse-all');
    const resetBtn = document.getElementById('reset');

    let progressState = JSON.parse(localStorage.getItem('roadmapProgress')) || {};

    function saveProgress() {
        localStorage.setItem('roadmapProgress', JSON.stringify(progressState));
        updateProgress();
    }

    function updateProgress() {
        let totalTasks = 0;
        let completedTasks = 0;

        roadmapData.forEach((section, sectionIndex) => {
            section.subtasks.forEach((subtask, subtaskIndex) => {
                subtask.items.forEach((item, itemIndex) => {
                    totalTasks++;
                    const key = `task-${sectionIndex}-${subtaskIndex}-${itemIndex}`;
                    if (progressState[key]) {
                        completedTasks++;
                    }
                });
            });
        });

        const progressPercent = totalTasks ? (completedTasks / totalTasks) * 100 : 0;
        progressBar.style.width = `${progressPercent}%`;
        progressText.textContent = `${Math.round(progressPercent)}% завершено`;
    }

    function renderRoadmap() {
        roadmap.innerHTML = '';
        roadmapData.forEach((section, sectionIndex) => {
            const sectionDiv = document.createElement('div');
            sectionDiv.classList.add('section');

            const sectionHeader = document.createElement('div');
            sectionHeader.classList.add('section-header');
            sectionHeader.innerHTML = `<span>${section.title}</span><i class="fas fa-chevron-down"></i>`;
            sectionHeader.addEventListener('click', () => {
                const content = sectionDiv.querySelector('.section-content');
                const icon = sectionHeader.querySelector('i');
                content.classList.toggle('show');
                icon.classList.toggle('fa-chevron-down');
                icon.classList.toggle('fa-chevron-up');
            });

            const sectionContent = document.createElement('div');
            sectionContent.classList.add('section-content');

            section.subtasks.forEach((subtask, subtaskIndex) => {
                const subtaskDiv = document.createElement('div');
                subtaskDiv.classList.add('subtask-group');
                subtaskDiv.innerHTML = `<h3>${subtask.title}</h3>`;

                subtask.items.forEach((item, itemIndex) => {
                    const taskDiv = document.createElement('div');
                    taskDiv.classList.add('subtask');
                    const key = `task-${sectionIndex}-${subtaskIndex}-${itemIndex}`;
                    const isChecked = progressState[key] || false;

                    taskDiv.innerHTML = `
                        <input type="checkbox" ${isChecked ? 'checked' : ''}>
                        <span>${item}</span>
                    `;

                    const checkbox = taskDiv.querySelector('input');
                    checkbox.addEventListener('change', () => {
                        progressState[key] = checkbox.checked;
                        taskDiv.classList.toggle('completed', checkbox.checked);
                        saveProgress();
                    });

                    if (isChecked) {
                        taskDiv.classList.add('completed');
                    }

                    subtaskDiv.appendChild(taskDiv);
                });

                sectionContent.appendChild(subtaskDiv);
            });

            sectionDiv.appendChild(sectionHeader);
            sectionDiv.appendChild(sectionContent);
            roadmap.appendChild(sectionDiv);
        });

        updateProgress();
    }

    expandAllBtn.addEventListener('click', () => {
        document.querySelectorAll('.section-content').forEach(content => {
            content.classList.add('show');
            content.previousElementSibling.querySelector('i').classList.remove('fa-chevron-down');
            content.previousElementSibling.querySelector('i').classList.add('fa-chevron-up');
        });
    });

    collapseAllBtn.addEventListener('click', () => {
        document.querySelectorAll('.section-content').forEach(content => {
            content.classList.remove('show');
            content.previousElementSibling.querySelector('i').classList.remove('fa-chevron-up');
            content.previousElementSibling.querySelector('i').classList.add('fa-chevron-down');
        });
    });

    resetBtn.addEventListener('click', () => {
        if (confirm('Вы уверены, что хотите сбросить весь прогресс?')) {
            progressState = {};
            localStorage.removeItem('roadmapProgress');
            renderRoadmap();
        }
    });

    renderRoadmap();
</script>
{% endblock %}